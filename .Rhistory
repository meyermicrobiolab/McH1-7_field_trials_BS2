OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps5_BS2_jan <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps5_BS2_jan
ps_corn = subset_samples(ps5_BS2_jan, Proportion_TissueLost_Jan21 != "nd")
ps_corn
ps_corn <- prune_taxa(taxa_sums(ps_corn) > 1, ps_corn) #remove taxa not found in remaining samples
ps_corn
set.seed(1)
tissueJan.da <- differentialTest(formula = ~ Proportion_TissueLost_Jan21,
phi.formula = ~ Proportion_TissueLost_Jan21,
formula_null = ~ 1,
phi.formula_null = ~ Proportion_TissueLost_Jan21,
test = "LRT", boot = FALSE,
data = ps_corn,
fdr_cutoff = 0.05)
View(samples)
otu <- read.table("silva_nochloronomito_otu_table_ps5_BS2_jan corncob.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps5_BS2_jan_corncob.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps5_BS2_jan.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps5_BS2_jan <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps5_BS2_jan
ps_corn = subset_samples(ps5_BS2_jan, Proportion_TissueLost_Jan21 != "nd")
ps_corn
ps_corn <- prune_taxa(taxa_sums(ps_corn) > 1, ps_corn) #remove taxa not found in remaining samples
ps_corn
# use an ASV table that has been filtered to remove low-abundance ASVs, no blanks, replaced sequences with ASV numbers in both otu table and taxa table, added a column named "Species" to the taxa table to fill in later with ASV number
otu <- read.table("silva_nochloronomito_otu_table_ps5_BS2_jan corncob.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps5_BS2_jan_corncob.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps5_BS2_jan.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps5_BS2_jan <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps5_BS2_jan
View(samples)
sample_data(ps5_BS2_jan)$Treatment<-factor(sample_data(ps5_BS2_jan)$Treatment,levels=c("none","probiotic bag","probiotic paste","control bag","control paste","resistant"))
set.seed(1)
treatment.da <- differentialTest(formula = ~ Treatment,
phi.formula = ~ Treatment,
formula_null = ~ 1,
phi.formula_null = ~ Treatment,
test = "Wald", boot = FALSE,
data = ps5_BS2_jan,
fdr_cutoff = 0.05)
#quick look at results with corncob's plotting feature
plot(treatment.da)
extractmods <- function(model) {
result <- data.frame("Estimate" = model$coefficients[2, 1],
"Std.Error" = model$coefficients[2, 2],
"p" = model$coefficients[2, 4])
return(result)
}
treatment.da.models <- lapply(treatment.da$significant_models, extractmods)
names(treatment.da.models) <- treatment.da$significant_taxa
tax_table(ps5_BS2_jan)[,7] <- rownames(tax_table(ps5_BS2_jan))
sig.taxonomy.treatment <- as.data.frame(tax_table(ps5_BS2_jan)[treatment.da$significant_taxa,])
treatment.da.models.df <- ldply(treatment.models, data.frame) %>%
left_join(sig.taxonomy.treatment, by = c(".id" = "Species")) %>%
mutate(genusasv = paste0(Genus, "_(", .id,")"))
treatment.da.models.df <- ldply(treatment.da.models, data.frame) %>%
left_join(sig.taxonomy.treatment, by = c(".id" = "Species")) %>%
mutate(genusasv = paste0(Genus, "_(", .id,")"))
### Save these data so you don't have to re-run the model ###
write.table(treatment.da.models.df, "DA_treatment.txt", sep="\t",row.names = FALSE)
View(treatment.da.models.df)
knitr::opts_chunk$set(echo = TRUE)
library(dada2)
library(ggplot2)
library(phyloseq)
library(vegan)
library(pairwiseAdonis) # install from github using devtools
library(knitr)
library(CoDaSeq)
library(dplyr)
library(plyr)
library(cowplot)
library(randomcoloR)
library(reshape2)
library(corncob)
writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
########### make bubble plots per month and then stitch together with cowplot ################
#### read in data for plot
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
View(asv_meta)
asv-aug<-asv_meta[which(asv_meta$Collection.month=='Aug'),]
asv-aug<-asv_meta[which(asv_meta$Collection.month=='Aug'),]
asv_aug<-asv_meta[which(asv_meta$Collection.month=='Aug'),]
View(asv_aug)
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
asv_aug<-asv_meta[which(asv_meta$Collection.month=='Aug'),]
asv_oct<-asv_meta[which(asv_meta$Collection.month=='Oct'),]
asv_jan<-asv_meta[which(asv_meta$Collection.month=='Jan'),]
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_aug$Treatment<-factor(asv_aug$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_oct$Treatment<-factor(asv_oct$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_jan$Treatment<-factor(asv_jan$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_aug$ASV<-factor(asv_aug$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_oct$ASV<-factor(asv_oct$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_jan$ASV<-factor(asv_jan$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
asv_oct <- asv_oct %>% group_by(sampled) %>% arrange(factor(Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none")), .by_group = TRUE)
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
asv_aug<-asv_meta[which(asv_meta$Collection.month=='Aug'),]
asv_oct<-asv_meta[which(asv_meta$Collection.month=='Oct'),]
asv_jan<-asv_meta[which(asv_meta$Collection.month=='Jan'),]
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_aug$Treatment<-factor(asv_aug$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_oct$Treatment<-factor(asv_oct$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_jan$Treatment<-factor(asv_jan$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_aug$ASV<-factor(asv_aug$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_oct$ASV<-factor(asv_oct$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_jan$ASV<-factor(asv_jan$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_oct <- asv_oct %>% arrange(factor(Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none")), .by_group = TRUE)
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
asv_aug<-asv_meta[which(asv_meta$Collection.month=='Aug'),]
asv_oct<-asv_meta[which(asv_meta$Collection.month=='Oct'),]
asv_jan<-asv_meta[which(asv_meta$Collection.month=='Jan'),]
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_aug$Treatment<-factor(asv_aug$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_oct$Treatment<-factor(asv_oct$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_jan$Treatment<-factor(asv_jan$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_aug$ASV<-factor(asv_aug$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_oct$ASV<-factor(asv_oct$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_jan$ASV<-factor(asv_jan$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
#scale_x_discrete(limits = c("probiotic bag","probiotic paste","control bag","control paste","none"))+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
scale_x_discrete(limits = c("probiotic bag","probiotic paste","control bag","control paste","none"))+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
scale_x_discrete(limit = c("probiotic bag","probiotic paste","control bag","control paste","none"))+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
asv_oct$Treatment <- as.character(asv_oct$Treatment)
asv_oct$Treatment<-factor(asv_oct$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
asv_oct2 <- asv_oct %>%
arrange(val) %>%
mutate(name = factor(name, levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))) %>%
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
asv_oct2 <- asv_oct %>%
arrange(val) %>%
mutate(name = factor(name, levels=c("probiotic bag","probiotic paste","control bag","control paste","none")))
View(asv_oct)
asv_oct2 <- asv_oct %>%
arrange(sample) %>%
mutate(name = factor(name, levels=c("probiotic bag","probiotic paste","control bag","control paste","none")))
asv_oct2 <- asv_oct %>%
arrange(sample) %>%
mutate(Treatment = factor(Treatment, levels=c("probiotic bag","probiotic paste","control bag","control paste","none")))
View(asv_oct2)
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
bubble2 <- ggplot(asv_oct2, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ Treatment, scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
pdf("bubble_Oct.pdf",bg ="white",width=12,height=4.5)
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ Treatment, scales="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
dev.off()
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ Treatment, scales="free",space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
pdf("bubble_Oct.pdf",bg ="white",width=11)
bubble2 <- ggplot(asv_oct, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ Treatment, scales="free",space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble2
dev.off()
bubble1 <- ggplot(asv_aug, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble1
View(asv_meta)
pdf("bubble_Aug.pdf",bg ="white",width=11)
bubble1 <- ggplot(asv_aug, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+ #adjust the two numbers here to change bubble sizes
facet_grid(Condition ~ ., scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble1
dev.off()
pdf("bubble_Jan.pdf",bg ="white",width=11)
bubble3 <- ggplot(asv_jan, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+ # the alpha value is the opacity of the bubble
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ Treatment, scales="free",space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble3
dev.off()
bubble3
bubble1
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_meta$sampled<-factor(asv_meta$sampled,levels=c("Before treatment","Two weeks after treatment","Two months after treatment"))
asv_meta$Treatment<-factor(asv_meta$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_meta$ASV<-factor(asv_meta$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
#make bubble plot
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
pdf("bubble_all.pdf",bg ="white",width=11)
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
dev.off()
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
#set the plot aesthetics
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_meta$sampled<-factor(asv_meta$sampled,levels=c("Before treatment","Two weeks after treatment","Two months after treatment"))
asv_meta$Treatment<-factor(asv_meta$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_meta$ASV<-factor(asv_meta$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
View(asv_meta)
asv_meta2 <- asv_meta %>% group_by(sampled) %>% arrange(factor(Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none")), .by_group = TRUE)
meta<-read.table("metadata_ps20_ordered.txt",sep="\t",header=T,row.names=1)
View(meta)
# make sample names a column
meta <- tibble::rownames_to_column(meta, "sample")
print(meta$sample)
#### read in data for plot
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
View(asv_meta)
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
#set the plot aesthetics
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_meta$sampled<-factor(asv_meta$sampled,levels=c("Before treatment","Two weeks after treatment","Two months after treatment"))
asv_meta$Treatment<-factor(asv_meta$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_meta$ASV<-factor(asv_meta$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_meta$sample<-factor(asv_meta$sample,levels=c("BS2-1566-DD-A", "BS2-1566-HD-A", "BS2-1689-DD-A", "BS2-1689-HD-A", "BS2-1842-DD-A","BS2-1842-HD-A", "BS2-1925-DD-A", "BS2-1925-HD-A", "BS2-2006-DD-A", "BS2-2006-HD-A","BS2-2019-DD-A", "BS2-2019-HD-A", "BS2-2048-DD-A", "BS2-2048-HD-A", "BS2-2076-DD-A","BS2-2076-HD-A", "BS2-2078-DD-A", "BS2-2078-HH-A", "BS2-2079-DD-A", "BS2-2079-HD-A","BS2-2091-DD-A", "BS2-2091-HD-A", "BS2-2149-DD-A", "BS2-2149-HD-A", "BS2-2155-DD-A","BS2-2155-HD-A", "BS2-2179-DD-A", "BS2-2179-HD-A", "BS2-2180-DD-A", "BS2-2180-HD-A","BS2-2198-DD-A", "BS2-2198-HD-A", "BS2-2415-DD-A", "BS2-2415-HD-A", "BS2-2433-DD-A","BS2-2433-HD-A", "BS2-2474-DD-A", "BS2-2474-HD-A", "BS2-2482-DD-A", "BS2-2482-HD-A","BS2-2483-HD-A", "BS2-1689-DD-O", "BS2-1689-HD-O", "BS2-1842-DD-O", "BS2-1842-HD-O","BS2-1925-DD-O", "BS2-1925-HD-O", "BS2-2019-DD-O", "BS2-2019-HD-O", "BS2-2415-DD-O","BS2-2415-HD-O", "BS2-1566-DD-O", "BS2-1566-HD-O", "BS2-2006-DD-O", "BS2-2006-HD-O","BS2-2079-DD-O", "BS2-2079-HD-O", "BS2-2149-DD-O", "BS2-2149-HD-O", "BS2-2433-DD-O","BS2-2433-HD-O", "BS2-2048-DD-O", "BS2-2048-HD-O", "BS2-2076-DD-O", "BS2-2076-HD-O","BS2-2180-DD-O", "BS2-2180-HD-O", "BS2-2198-DD-O", "BS2-2198-HD-O", "BS2-2475-DD-O","BS2-2475-HD-O", "BS2-2479-DD-O", "BS2-2479-HD-O", "BS2-2091-DD-O", "BS2-2091-HD-O","BS2-2155-DD-O", "BS2-2155-HD-O", "BS2-2179-DD-O", "BS2-2179-HD-O", "BS2-2500-DD-O","BS2-2500-HD-O", "BS2-2078-DD-O", "BS2-2078-HD-O", "BS2-2474-DD-O", "BS2-2474-HD-O","BS2-2482-DD-O", "BS2-2482-HD-O", "BS2-2483-DD-O", "BS2-2483-HD-O", "BS2-1689-DD-D","BS2-1689-HD-D", "BS2-1842-HD-D", "BS2-1925-HD-D", "BS2-2019-HD-D", "BS2-2415-HD-D","BS2-1566-DD-D", "BS2-1566-HD-D", "BS2-2006-DD-D", "BS2-2006-HD-D", "BS2-2079-DD-D","BS2-2079-HD-D", "BS2-2149-HD-D", "BS2-2433-HD-D", "BS2-2433-DD-D", "BS2-2048-DD-D","BS2-2048-HD-D", "BS2-2076-HD-D", "BS2-2180-DD-D", "BS2-2180-HD-D", "BS2-2475-DD-D","BS2-2475-HD-D", "BS2-2479-DD-D", "BS2-2479-HD-D", "BS2-2091-DD-D", "BS2-2091-HD-D","BS2-2155-DD-D", "BS2-2155-HD-D", "BS2-2179-HD-D", "BS2-2500-DD-D", "BS2-2500-HD-D","BS2-2078-HD-D", "BS2-2474-DD-D", "BS2-2474-HD-D", "BS2-2483-DD-D", "BS2-2483-HD-D"))
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
pdf("bubble_all.pdf",bg ="white",width=11)
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
dev.off()
asv <- read.table("silva_nochloronomito_otu_table_ps20_v4.txt",sep="\t",header=TRUE, row.names=1)
# make sample names a column
asv <- tibble::rownames_to_column(asv, "sample")
asv_long<-melt(asv, id.vars=c("sample"))
names(asv_long)[names(asv_long)=="variable"] <- "ASV"
names(asv_long)[names(asv_long)=="value"] <- "relative_abundance"
meta<-read.table("metadata_ps20.txt",sep="\t",header=T,row.names=1)
# make sample names a column
meta <- tibble::rownames_to_column(meta, "sample")
#merge asv table and metadata
asv_meta <- merge(asv_long,meta, "sample")
write.table(asv_meta,"asv_meta.txt",sep="\t",col.names=NA)
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
#set the plot aesthetics
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_meta$sampled<-factor(asv_meta$sampled,levels=c("Before treatment","Two weeks after treatment","Two months after treatment"))
asv_meta$Treatment<-factor(asv_meta$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_meta$ASV<-factor(asv_meta$ASV,levels=c("Other","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
# set the order of samples on the x-axis so that they appear in the same order every month, with treatment types grouped in oct and jan; I tried many different ways and the only solution I could come up with was to sort the meta in the order that I wanted using excel so that samples are ordered by collection date and then the treatments in my preferred order within each sample date, and sorted by coral tag number within that. Read in the manually ordered metadata, print out the sample names, and then set that list as a factor to maintain the order in the plot. IT WORKED!!!
# meta<-read.table("metadata_ps20_ordered.txt",sep="\t",header=T,row.names=1)
# make sample names a column
# meta <- tibble::rownames_to_column(meta, "sample")
# print(meta$sample)
asv_meta$sample<-factor(asv_meta$sample,levels=c("BS2-1566-DD-A", "BS2-1566-HD-A", "BS2-1689-DD-A", "BS2-1689-HD-A", "BS2-1842-DD-A","BS2-1842-HD-A", "BS2-1925-DD-A", "BS2-1925-HD-A", "BS2-2006-DD-A", "BS2-2006-HD-A","BS2-2019-DD-A", "BS2-2019-HD-A", "BS2-2048-DD-A", "BS2-2048-HD-A", "BS2-2076-DD-A","BS2-2076-HD-A", "BS2-2078-DD-A", "BS2-2078-HH-A", "BS2-2079-DD-A", "BS2-2079-HD-A","BS2-2091-DD-A", "BS2-2091-HD-A", "BS2-2149-DD-A", "BS2-2149-HD-A", "BS2-2155-DD-A","BS2-2155-HD-A", "BS2-2179-DD-A", "BS2-2179-HD-A", "BS2-2180-DD-A", "BS2-2180-HD-A","BS2-2198-DD-A", "BS2-2198-HD-A", "BS2-2415-DD-A", "BS2-2415-HD-A", "BS2-2433-DD-A","BS2-2433-HD-A", "BS2-2474-DD-A", "BS2-2474-HD-A", "BS2-2482-DD-A", "BS2-2482-HD-A","BS2-2483-HD-A", "BS2-1689-DD-O", "BS2-1689-HD-O", "BS2-1842-DD-O", "BS2-1842-HD-O","BS2-1925-DD-O", "BS2-1925-HD-O", "BS2-2019-DD-O", "BS2-2019-HD-O", "BS2-2415-DD-O","BS2-2415-HD-O", "BS2-1566-DD-O", "BS2-1566-HD-O", "BS2-2006-DD-O", "BS2-2006-HD-O","BS2-2079-DD-O", "BS2-2079-HD-O", "BS2-2149-DD-O", "BS2-2149-HD-O", "BS2-2433-DD-O","BS2-2433-HD-O", "BS2-2048-DD-O", "BS2-2048-HD-O", "BS2-2076-DD-O", "BS2-2076-HD-O","BS2-2180-DD-O", "BS2-2180-HD-O", "BS2-2198-DD-O", "BS2-2198-HD-O", "BS2-2475-DD-O","BS2-2475-HD-O", "BS2-2479-DD-O", "BS2-2479-HD-O", "BS2-2091-DD-O", "BS2-2091-HD-O","BS2-2155-DD-O", "BS2-2155-HD-O", "BS2-2179-DD-O", "BS2-2179-HD-O", "BS2-2500-DD-O","BS2-2500-HD-O", "BS2-2078-DD-O", "BS2-2078-HD-O", "BS2-2474-DD-O", "BS2-2474-HD-O","BS2-2482-DD-O", "BS2-2482-HD-O", "BS2-2483-DD-O", "BS2-2483-HD-O", "BS2-1689-DD-D","BS2-1689-HD-D", "BS2-1842-HD-D", "BS2-1925-HD-D", "BS2-2019-HD-D", "BS2-2415-HD-D","BS2-1566-DD-D", "BS2-1566-HD-D", "BS2-2006-DD-D", "BS2-2006-HD-D", "BS2-2079-DD-D","BS2-2079-HD-D", "BS2-2149-HD-D", "BS2-2433-HD-D", "BS2-2433-DD-D", "BS2-2048-DD-D","BS2-2048-HD-D", "BS2-2076-HD-D", "BS2-2180-DD-D", "BS2-2180-HD-D", "BS2-2475-DD-D","BS2-2475-HD-D", "BS2-2479-DD-D", "BS2-2479-HD-D", "BS2-2091-DD-D", "BS2-2091-HD-D","BS2-2155-DD-D", "BS2-2155-HD-D", "BS2-2179-HD-D", "BS2-2500-DD-D", "BS2-2500-HD-D","BS2-2078-HD-D", "BS2-2474-DD-D", "BS2-2474-HD-D", "BS2-2483-DD-D", "BS2-2483-HD-D"))
#make bubble plot
pdf("bubble_all.pdf",bg ="white",width=11)
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
dev.off()
View(asv_meta)
#### read in data for plot
asv_meta<-read.table("asv_meta.txt",sep="\t",header=T,row.names=1)
View(asv_meta)
cols<-c("none"="#999999","probiotic paste"="#D55E00","probiotic bag"="#E69F00","control paste"="#0072B2","control bag"="#56B4E9")
asv_meta$sampled<-factor(asv_meta$sampled,levels=c("Before treatment","Two weeks after treatment","Two months after treatment"))
asv_meta$Treatment<-factor(asv_meta$Treatment,levels=c("probiotic bag","probiotic paste","control bag","control paste","none"))
asv_meta$ASV<-factor(asv_meta$ASV,levels=c("Other_n.716","Roseibacillus_ASV1","Enhydrobacter_ASV1","Halomonas_ASV2","Halomonas_ASV1","Endozoicomonas_ASV3","Endozoicomonas_ASV2","Endozoicomonas_ASV1","Vibrio_ASV4","Vibrio_ASV3","Vibrio_ASV2","Vibrio_ASV1","Photobacterium_ASV1","Psychrobium_ASV1","Pseudoalteromonas_ASV2","Pseudoalteromonas_ASV1","Thalassobius_ASV1","Ruegeria_ASV1","Nautella_ASV1","Halodesulfovibrio_ASV1","Renibacterium_ASV1"))
asv_meta$sample<-factor(asv_meta$sample,levels=c("BS2-1566-DD-A", "BS2-1566-HD-A", "BS2-1689-DD-A", "BS2-1689-HD-A", "BS2-1842-DD-A","BS2-1842-HD-A", "BS2-1925-DD-A", "BS2-1925-HD-A", "BS2-2006-DD-A", "BS2-2006-HD-A","BS2-2019-DD-A", "BS2-2019-HD-A", "BS2-2048-DD-A", "BS2-2048-HD-A", "BS2-2076-DD-A","BS2-2076-HD-A", "BS2-2078-DD-A", "BS2-2078-HH-A", "BS2-2079-DD-A", "BS2-2079-HD-A","BS2-2091-DD-A", "BS2-2091-HD-A", "BS2-2149-DD-A", "BS2-2149-HD-A", "BS2-2155-DD-A","BS2-2155-HD-A", "BS2-2179-DD-A", "BS2-2179-HD-A", "BS2-2180-DD-A", "BS2-2180-HD-A","BS2-2198-DD-A", "BS2-2198-HD-A", "BS2-2415-DD-A", "BS2-2415-HD-A", "BS2-2433-DD-A","BS2-2433-HD-A", "BS2-2474-DD-A", "BS2-2474-HD-A", "BS2-2482-DD-A", "BS2-2482-HD-A","BS2-2483-HD-A", "BS2-1689-DD-O", "BS2-1689-HD-O", "BS2-1842-DD-O", "BS2-1842-HD-O","BS2-1925-DD-O", "BS2-1925-HD-O", "BS2-2019-DD-O", "BS2-2019-HD-O", "BS2-2415-DD-O","BS2-2415-HD-O", "BS2-1566-DD-O", "BS2-1566-HD-O", "BS2-2006-DD-O", "BS2-2006-HD-O","BS2-2079-DD-O", "BS2-2079-HD-O", "BS2-2149-DD-O", "BS2-2149-HD-O", "BS2-2433-DD-O","BS2-2433-HD-O", "BS2-2048-DD-O", "BS2-2048-HD-O", "BS2-2076-DD-O", "BS2-2076-HD-O","BS2-2180-DD-O", "BS2-2180-HD-O", "BS2-2198-DD-O", "BS2-2198-HD-O", "BS2-2475-DD-O","BS2-2475-HD-O", "BS2-2479-DD-O", "BS2-2479-HD-O", "BS2-2091-DD-O", "BS2-2091-HD-O","BS2-2155-DD-O", "BS2-2155-HD-O", "BS2-2179-DD-O", "BS2-2179-HD-O", "BS2-2500-DD-O","BS2-2500-HD-O", "BS2-2078-DD-O", "BS2-2078-HD-O", "BS2-2474-DD-O", "BS2-2474-HD-O","BS2-2482-DD-O", "BS2-2482-HD-O", "BS2-2483-DD-O", "BS2-2483-HD-O", "BS2-1689-DD-D","BS2-1689-HD-D", "BS2-1842-HD-D", "BS2-1925-HD-D", "BS2-2019-HD-D", "BS2-2415-HD-D","BS2-1566-DD-D", "BS2-1566-HD-D", "BS2-2006-DD-D", "BS2-2006-HD-D", "BS2-2079-DD-D","BS2-2079-HD-D", "BS2-2149-HD-D", "BS2-2433-HD-D", "BS2-2433-DD-D", "BS2-2048-DD-D","BS2-2048-HD-D", "BS2-2076-HD-D", "BS2-2180-DD-D", "BS2-2180-HD-D", "BS2-2475-DD-D","BS2-2475-HD-D", "BS2-2479-DD-D", "BS2-2479-HD-D", "BS2-2091-DD-D", "BS2-2091-HD-D","BS2-2155-DD-D", "BS2-2155-HD-D", "BS2-2179-HD-D", "BS2-2500-DD-D", "BS2-2500-HD-D","BS2-2078-HD-D", "BS2-2474-DD-D", "BS2-2474-HD-D", "BS2-2483-DD-D", "BS2-2483-HD-D"))
pdf("bubble_all.pdf",bg ="white",width=11)
bubble <- ggplot(asv_meta, aes(x=sample,y=ASV,size=relative_abundance,color=Treatment))+
geom_point(alpha=0.8)+
scale_size(range = c(0,10), name="Relative abundance")+
facet_grid(Condition ~ sampled, scales="free", space="free")+
theme_bw()+
scale_color_manual(values=cols)+
theme(axis.text.x=element_blank())+
theme(axis.text.y=element_text(size=10))+
theme(axis.title.x=element_blank())+
theme(axis.title.y=element_blank())+
theme(legend.text = element_text(size=10))
bubble
dev.off()
